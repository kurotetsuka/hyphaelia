# general tasks
task :default => [ :build ]
task :freshen => [ :clean, :build]

# vars
version = "0.2.0"

# clean
task :clean => [
	:clean_libdttp, :clean_dttpc, :clean_dttpd,
	:clean_web, :clean_pkg]

task :clean_libdttp do
	%x[ cd libdttp && cargo clean ]
end
task :clean_dttpc do
	%x[ cd dttpc && cargo clean ]
end
task :clean_dttpd do
	%x[ cd dttpd && cargo clean ]
end
task :clean_web do
	%x[ cd web && rake clean ]
end
task :clean_pkg do
	%x[ rm -rf pkg/*.tar.gz ]
end

# build
task :build => [
	:build_libdttp, :build_dttpc, :build_dttpd]

task :build_libdttp do
	%x[ cd libdttp && cargo build ]
end
task :build_dttpc do
	%x[ cd dttpc && cargo build ]
end
task :build_dttpd do
	%x[ cd dttpd && cargo build ]
end

# package
task :package do
	%x[ tar -zcvf pkg/hyphaelia-#{version}.tar.gz \
		dttpc dttpd libdttp legal notes tool web \
		license.md rakefile readme.md pkg/.gitignore]
end

# deployment/testing
#task :test => [ :gen, :deploy]
#task :undeploy do
#
#end
#task :deploy do
#
#end
