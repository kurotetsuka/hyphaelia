# general tasks
task :default => [ :build ]
task :freshen => [ :clean, :build ]

# vars
version = "0.2.0"

# clean
task :clean => [
	"clean:libdttp",
	"clean:dttpc",
	"clean:dttpd",
	"clean:web",
	"clean:pkg"]

namespace :clean do
	task :libdttp do
		%x[ cd libdttp && cargo clean ]
	end
	task :dttpc do
		%x[ cd dttpc && cargo clean ]
	end
	task :dttpd do
		%x[ cd dttpd && cargo clean ]
	end
	task :web do
		%x[ cd web && rake clean ]
	end
	task :pkg do
		%x[ rm -rf pkg/*.tar.gz ]
	end
end

# build
task :build => [
	"build:libdttp",
	"build:dttpc",
	"build:dttpd"]

namespace :build do
	task :libdttp do
		%x[ cd libdttp && cargo build ]
	end
	task :dttpc do
		%x[ cd dttpc && cargo build ]
	end
	task :dttpd do
		%x[ cd dttpd && cargo build ]
	end
end

# package
task :package do
	%x[ tar -zcvf pkg/hyphaelia-#{version}.tar.gz \
		dttpc dttpd libdttp legal notes tool web \
		license.md rakefile readme.md pkg/.gitignore]
end

# deployment/testing
#task :test => [ :gen, :deploy]
#task :undeploy do
#
#end
#task :deploy do
#
#end
